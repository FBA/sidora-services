<?xml version="1.0" encoding="UTF-8"?>

<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0"
    xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd">

    <!-- OSGI blueprint property placeholder -->
    <cm:property-placeholder id="system.placeholder" persistent-id="camel.blueprint"/>

    <!-- <bean id="cameraTrapRoutes" class="edu.si.services.beans.cameratrap.CameraTrapRouteBuilder"/> -->

    <camelContext id="CTIngestCamelContext"
                  xmlns="http://camel.apache.org/schema/blueprint"
                  xmlns:ri="http://www.w3.org/2001/sw/DataAccess/rf1/result" 
                  xmlns:fits="http://hul.harvard.edu/ois/xml/ns/fits/fits_output"
                  trace="false">

        <!-- Using a Camel properties component and referring to the blueprint property placeholder by its ID. -->
        <!--
        <propertyPlaceholder id="properties"
                             location="blueprint:system.placeholder,file:${karaf.home}/etc/system.properties"/>
        -->

        <!-- <routeBuilder ref="cameraTrapRoutes"/> -->

        <route id="CameraTrapStartProcessing">
            <from uri="file:Test?moveFailed=ErrorTrap&amp;delete=true"/>

            <!-- Add Schematron validation. -->
            <to uri="schematron:///opt/sidora/servicemix/Input/schemas/DeploymentManifest2014.sch"/>
            <log message="${id} CameraTrapIngest: Schematron Validation Status - ${header.CamelSchematronValidationStatus}"/>

            <log message="${id} CameraTrapIngest: Finished Camera Trap processing!"/>
        </route>

    </camelContext>
</blueprint>